%%THIS FILE FOR GENERATING THE LEGENDRE POLYNOMIALS SO THAT THE
%%DIFFERENTIATION IS NOT REQUIRED IN EACH CALCULATIONS!
function output=LEGENPOLY(KK,x)
if KK==0;
    output=1.0;
elseif KK==1;
    output= x;
elseif KK==2;
    output=1.5*x.^2 - 0.5;
elseif KK==3;
    output= 0.5*x.*(5.0*x.^2 - 3.0);
elseif KK==4;
    output= 4.375*x.^4 - 3.75*x.^2 + 0.375;
elseif KK==5;
    output=  0.125*x.*(63.0*x.^4 - 70.0*x.^2 + 15.0);
elseif KK==6;
    output= 14.4375*x.^6 - 19.6875*x.^4 + 6.5625*x.^2 - 0.3125;
elseif KK==7;
    output= 0.062499999999999999945789891375725*x.*(429.0*x.^6 - 693.0*x.^4 + 315.0*x.^2 - 35.0);
elseif KK==8;
    output= 50.273437499999999956394743875349*x.^8 - 93.843749999999999918603521900651*x.^6 + 54.140624999999999953040493404222*x.^4 - 9.8437499999999999914619078916767*x.^2 + 0.2734374999999999997628307747688;
elseif KK==9;
    output= 0.0078125000000000005268544931921748*x.*(12155.0*x.^8 - 25740.0*x.^6 + 18018.0*x.^4 - 4620.0*x.^2 + 315.0);
elseif KK==10;
    output= 180.42578124999998443858619051009*x.^10 - 427.32421874999996314401992489232*x.^8 + 351.91406249999996964801640873485*x.^6 - 117.30468749999998988267213624495*x.^4 + 13.535156249999998832616015720571*x.^2 - 0.24609374999999997877483664946493;
elseif KK==11;
    output=  0.0039062500000000002259063340106821*x.*(88179.0*x.^10 - 230945.0*x.^8 + 218790.0*x.^6 - 90090.0*x.^4 + 15015.0*x.^2 - 693.0);
elseif KK==12;
    output= 660.19433593750003818037303456187*x.^12 - 1894.4707031250001095610704470036*x.^10 + 2029.7900390625001173868611932182*x.^8 - 997.08984375000005766372128789665*x.^6 + 219.94628906250001271993851938897*x.^4 - 17.595703125000001017595081551117*x.^2 + 0.22558593750000001304609078911689;
elseif KK==13;
    output= 0.00097656249999999992346787970870434*x.*(1300075.0*x.^12 - 4056234.0*x.^10 + 4849845.0*x.^8 - 2771340.0*x.^6 + 765765.0*x.^4 - 90090.0*x.^2 + 3003.0);
elseif KK==14;
    output= 2448.5229492187499559091459467147*x.^14 - 8252.4291992187498513974918944828*x.^12 + 10893.206542968749803844689300717*x.^10 - 7104.2651367187498720726234569895*x.^8 + 2368.0883789062499573575411523298*x.^6 - 373.90869140624999326698018194682*x.^4 + 21.994628906249999603940010702754*x.^2 - 0.20947265624999999622800010193099;
elseif KK==15;
    output= 0.00048828124999999999550568105203889*x.*(9694845.0*x.^14 - 35102025.0*x.^12 + 50702925.0*x.^10 - 37182145.0*x.^8 + 14549535.0*x.^6 - 2909907.0*x.^4 + 255255.0*x.^2 - 6435.0);
elseif KK==16;
    output= 9171.7588806152342905797816867234*x.^16 - 35503.582763671874673212058142155*x.^14 + 55703.897094726561987280987774761*x.^12 - 45388.360595703124582228953001657*x.^10 + 20424.762268066406062003028850746*x.^8 - 4972.9855957031249542268244158337*x.^6 + 592.02209472656249455081243045639*x.^4 - 26.707763671874999754171989343897*x.^2 + 0.19638061523437499819244109811689;
elseif KK==17;
    output= 0.000030517578124999998208011532049119*x.*(583401555.0*x.^16 - 2404321560.0*x.^14 + 4071834900.0*x.^12 - 3650610600.0*x.^10 + 1859107250.0*x.^8 - 535422888.0*x.^6 + 81477396.0*x.^4 - 5542680.0*x.^2 + 109395.0);
elseif KK==18;
    output= 34618.893814086911422580090865558*x.^18 - 151334.02153015135564727868292658*x.^16 + 275152.76641845701026777942350288*x.^14 - 269235.50262451169821900997353508*x.^12 + 153185.71701049803519357464011478*x.^10 - 51061.905670166011731191546704928*x.^8 + 9531.5557250976555231557553849199*x.^6 - 888.03314208984368228159211660745*x.^4 + 31.71546936035156008148543273598*x.^2 - 0.18547058105468748585663995752035;
elseif KK==19;
    output= 0.000015258789062499999589011698391573*x.*(4418157975.0*x.^18 - 20419054425.0*x.^16 + 39671305740.0*x.^14 - 42075627300.0*x.^12 + 26466926850.0*x.^10 - 10039179150.0*x.^8 + 2230928700.0*x.^6 - 267711444.0*x.^4 + 14549535.0*x.^2 - 230945.0);
elseif KK==20;
    output= 131460.69414138793899215345019721*x.^20 - 640449.53556060790791049116762744*x.^18 + 1324172.6883888244582473668736081*x.^16 - 1513340.2153015136665684192841235*x.^14 + 1043287.57266998290649792541557*x.^12 - 444238.57933044433437976178985561*x.^10 + 114889.28775787353475338666979024*x.^8 - 17020.635223388671815316543672629*x.^6 + 1276.5476417541503861487407754472*x.^4 - 37.001380920410156120253355810063*x.^2 + 0.17619705200195312438215883719077;
elseif KK==21;
    output= 0.0000038146972656250002659070835886069*x.*(67282234305.0*x.^20 - 344616322050.0*x.^18 + 755505013725.0*x.^16 - 925663800600.0*x.^14 + 694247850450.0*x.^12 - 328189892940.0*x.^10 + 97045398450.0*x.^8 - 17210021400.0*x.^6 + 1673196525.0*x.^4 - 74364290.0*x.^2 + 969969.0);
elseif KK==22;
    output= 501656.28521919254949220786042214*x.^22 - 2694944.2298984529984348840873841*x.^20 + 6244382.971715927679300341178085*x.^18 - 8165731.5783977515806235230790342*x.^16 + 6620863.4419441229032082619559737*x.^14 - 3442848.9898109439096682962171063*x.^12 + 1147616.3299369813032227654057021*x.^10 - 237984.95321273805827200204265712*x.^8 + 28722.321939468386343172660320687*x.^6 - 1772.9828357696534779736210074498*x.^4 + 42.551588058471683471366904178795*x.^2 - 0.16818809509277345245599566869089;
elseif KK==23;
    output= 0.0000019073486328124997537935247570682*x.*(514589420475.0*x.^22 - 2893136075115.0*x.^20 + 7064634602025.0*x.^18 - 9821565178425.0*x.^16 + 8562390155550.0*x.^14 - 4859734953150.0*x.^12 + 1805044411170.0*x.^10 - 429772478850.0*x.^8 + 62386327575.0*x.^6 - 5019589575.0*x^4 + 185910725.0*x.^2 - 2028117.0);
elseif KK==24;
    output= 1922106.9623887539349332625832576*x.^24 - 11287266.417431831617905967510194*x.^22 + 28970650.471408367819291983276164*x.^20 - 42669950.306725502989654859088924*x.^18 + 39807941.444689036325714594150033*x.^16 - 24497194.735193253123516673323097*x.^14 + 10041642.886948585739819897623432*x.^12 - 2705095.6348514557503188295638632*x.^10 + 461095.84684967995744070958474941*x.^8 - 46274.852013587952718064044347612*x.^6 + 2393.5268282890320371412436731523*x.^4 - 48.354077339172364386691791376815*x.^2 + 0.16118025779724121462230597125605;
elseif KK==25;
    output= 0.00000023841857910156250714869404534028*x.*(15801325804719.0*x.^24 - 96742811049300.0*x.^22 + 260382246760350.0*x.^20 - 405039050516100.0*x.^18 + 402684172315425.0*x.^16 - 267146572853160.0*x.^14 + 119873462177700.0*x.^12 - 36100888223400.0*x.^10 + 7091245901025.0*x.^8 - 859544957700.0*x.^6 + 58227239070.0*x.^4 - 1825305300.0*x.^2 + 16900975.0);
elseif KK==26;
    output=7389761.9984761469686187368545816*x.^26 - 47091620.578524465976491950543902*x.^24 + 132625380.40482400621950794234813*x.^22 - 217279878.53556273359366194810226*x.^20 + 229350982.89864955212664316744127*x.^18 - 163212559.92322503011802978892333*x.^16 + 79615882.889378063472209653133329*x.^14 - 26538627.629792687824069884377776*x.^12 + 5917396.7012375587715831498950447*x.^10 - 845342.38589107982451187855643496*x.^8 + 71726.020621061318443432119939936*x^6 - 3155.1035463809964124676885604078*x.^4 + 54.398337006568903663236009662203*x.^2 - 0.15498101711273191926847866000628;
elseif KK==27;
    output=0.00000011920928955078124814337328195194*x.*(121683714103007.0*x.^26 - 805867616040669.0*x.^24 + 2370198870707850.0*x.^22 - 4079321865912150.0*x.^20 + 4556689318306125.0*x.^18 - 3463083881912655.0*x.^16 + 1825501581163260.0*x.^14 - 667866432132900.0*x.^12 + 166966608033225.0*x.^10 - 27577067392875.0*x.^8 + 2836498360410.0*x.^6 - 164094946470.0*x.^4 + 4411154475.0*x.^2 - 35102025.0);
elseif KK==28;
    output= 28493592.890949701075893093030601*x.^28 - 195828692.9596179455761379848285*x.^26 + 600418162.3761870972853287270685*x.^24 - 1083107273.3060629990245145664765*x.^22 + 1276519286.3964313917074635962045*x.^20 - 1032079423.0439232528698641841653*x.^18 + 584845006.39155650995958970436034*x.^16 - 233160799.89032153220980320439615*x.^14 + 64687904.847619693387475889024542*x.^12 - 12163537.663654985081405722722563*x.^10 + 1479349.1753093900774682635743658*x.^8 - 107589.03093159200563405553268115*x.^6 + 4075.3420807421214255324065409527*x.^4 - 60.675068199634562166735581254878*x.^2 + 0.14944598078727724671609749077556;
elseif KK==29;
    output= 0.000000029802322387695315503238918129841*x.*(1879204156221315.0*x.^28 - 13385208551330770.0*x.^26 + 42710983650155457.0*x.^24 - 80586761604066900.0*x.^22 + 99943385714847675.0*x.^20 - 85665759184155150.0*x.^18 + 51946258228689825.0*x.^16 - 22427590854291480.0*x.^14 + 6845630929362225.0*x.^12 - 1447043936287950.0*x.^10 + 204070298707275.0*x.^8 - 18050444111700.0*x.^6 + 902522205585.0*x.^4 - 21037813650.0*x.^2 + 145422675.0);
elseif KK==30;
    output=  110142474.58880901089748810872133*x.^30 - 812067397.39206643627809029311486*x.^28 + 2692644528.1947466045010362350651*x.^26 - 5303693767.6563190694717380387645*x.^24 + 6904808867.3261512413877344;
    
end
end